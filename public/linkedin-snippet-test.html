<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LinkedIn Snippet Testing - CuriosAI</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 40px; 
            background: #f5f5f5; 
            line-height: 1.6;
        }
        .container { 
            background: white; 
            padding: 30px; 
            border-radius: 10px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.1); 
            max-width: 900px;
            margin: 0 auto;
        }
        .test-snippet { 
            background: #f8f9fa; 
            padding: 15px; 
            border-radius: 5px; 
            margin: 10px 0;
            border-left: 4px solid #0095FF;
        }
        .result-url { 
            background: #e8f5e8; 
            padding: 10px; 
            border-radius: 5px; 
            font-family: monospace; 
            word-break: break-all;
            margin: 10px 0;
        }
        .teaser-preview {
            background: #fff3cd;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            border: 1px solid #ffeaa7;
        }
        button {
            background: #0095FF;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #0080FF; }
        .og-image-preview {
            max-width: 400px;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîó LinkedIn Snippet Testing - CuriosAI</h1>
        <p>Testing enhanced AI overview snippets for LinkedIn sharing with teaser descriptions.</p>
        
        <!-- Test Cases -->
        <div class="test-section">
            <h2>üß™ Test Case 1: Long AI Overview</h2>
            <div class="test-snippet">
                <strong>Original AI Overview:</strong><br>
                "Artificial intelligence is rapidly transforming industries across the globe. Machine learning algorithms are becoming increasingly sophisticated, enabling computers to perform tasks that traditionally required human intelligence. Recent advances in neural networks have led to breakthroughs in natural language processing, computer vision, and autonomous systems. These developments are reshaping how we work, communicate, and solve complex problems."
            </div>
            
            <div class="teaser-preview" id="teaser1">
                <strong>LinkedIn Teaser:</strong> <span id="teaser-text1"></span>
            </div>
            
            <div class="result-url" id="url1"></div>
            
            <button onclick="testSnippet1()">Test Snippet Processing</button>
            <button onclick="viewOGImage1()">View OG Image</button>
        </div>

        <div class="test-section">
            <h2>üß™ Test Case 2: Short AI Overview</h2>
            <div class="test-snippet">
                <strong>Original AI Overview:</strong><br>
                "Climate change solutions are emerging through renewable energy innovations. Solar and wind technologies continue to improve efficiency while reducing costs."
            </div>
            
            <div class="teaser-preview" id="teaser2">
                <strong>LinkedIn Teaser:</strong> <span id="teaser-text2"></span>
            </div>
            
            <div class="result-url" id="url2"></div>
            
            <button onclick="testSnippet2()">Test Snippet Processing</button>
            <button onclick="viewOGImage2()">View OG Image</button>
        </div>

        <div class="test-section">
            <h2>üß™ Test Case 3: Single Sentence</h2>
            <div class="test-snippet">
                <strong>Original AI Overview:</strong><br>
                "Space exploration has reached new milestones with private companies joining government agencies in developing advanced spacecraft and planning missions to Mars."
            </div>
            
            <div class="teaser-preview" id="teaser3">
                <strong>LinkedIn Teaser:</strong> <span id="teaser-text3"></span>
            </div>
            
            <div class="result-url" id="url3"></div>
            
            <button onclick="testSnippet3()">Test Snippet Processing</button>
            <button onclick="viewOGImage3()">View OG Image</button>
        </div>

        <!-- OG Image Preview -->
        <div class="test-section">
            <h2>üñºÔ∏è OG Image Preview</h2>
            <p>Preview of dynamically generated images with snippets:</p>
            <img id="og-preview" class="og-image-preview" style="display: none;" alt="OG Image Preview">
        </div>

        <!-- Results Summary -->
        <div class="test-section">
            <h2>üìä Expected LinkedIn Behavior</h2>
            <div class="teaser-preview">
                <strong>‚úÖ What LinkedIn Should Show:</strong><br>
                ‚Ä¢ <strong>Title:</strong> The search query (clean)<br>
                ‚Ä¢ <strong>Description:</strong> First 1-2 sentences + "..." (teaser)<br>
                ‚Ä¢ <strong>Image:</strong> Dynamic generated image with query + snippet<br>
                ‚Ä¢ <strong>Domain:</strong> curiosai.com<br>
                ‚Ä¢ <strong>Call-to-Action:</strong> Motivates users to click for full answer
            </div>
        </div>
    </div>

    <script>
        // Test snippet processing functions
        function processSnippet(text) {
            const sentences = text.split(/[.!?]+/).filter(s => s.trim().length > 0);
            
            if (sentences.length >= 2) {
                const teaser = sentences.slice(0, 2).join('. ').trim();
                return teaser.length > 140 ? teaser.substring(0, 137) + '...' : teaser + '...';
            } else if (sentences.length === 1) {
                const firstSentence = sentences[0].trim();
                return firstSentence.length > 100 ? firstSentence.substring(0, 137) + '...' : firstSentence + '...';
            } else {
                return text.length > 140 ? text.substring(0, 137) + '...' : text + '...';
            }
        }

        function generateLinkedInURL(query, snippet) {
            const baseUrl = window.location.origin;
            const searchUrl = `${baseUrl}/search?q=${encodeURIComponent(query)}`;
            
            // Add snippet parameter for edge function
            const urlObj = new URL(searchUrl);
            const snippetForUrl = snippet.length > 200 ? snippet.substring(0, 197) + '...' : snippet;
            urlObj.searchParams.set('snippet', snippetForUrl);
            
            return urlObj.toString();
        }

        function generateOGImageURL(query, snippet) {
            const baseUrl = window.location.origin;
            const encodedQuery = encodeURIComponent(query);
            const encodedSnippet = encodeURIComponent(snippet.substring(0, 150));
            return `${baseUrl}/.netlify/functions/og-image?query=${encodedQuery}&snippet=${encodedSnippet}`;
        }

        // Test Case 1
        function testSnippet1() {
            const originalText = "Artificial intelligence is rapidly transforming industries across the globe. Machine learning algorithms are becoming increasingly sophisticated, enabling computers to perform tasks that traditionally required human intelligence. Recent advances in neural networks have led to breakthroughs in natural language processing, computer vision, and autonomous systems. These developments are reshaping how we work, communicate, and solve complex problems.";
            const query = "artificial intelligence trends";
            
            const teaser = processSnippet(originalText);
            const linkedinUrl = generateLinkedInURL(query, originalText);
            
            document.getElementById('teaser-text1').textContent = teaser;
            document.getElementById('url1').textContent = linkedinUrl;
        }

        // Test Case 2
        function testSnippet2() {
            const originalText = "Climate change solutions are emerging through renewable energy innovations. Solar and wind technologies continue to improve efficiency while reducing costs.";
            const query = "climate change solutions";
            
            const teaser = processSnippet(originalText);
            const linkedinUrl = generateLinkedInURL(query, originalText);
            
            document.getElementById('teaser-text2').textContent = teaser;
            document.getElementById('url2').textContent = linkedinUrl;
        }

        // Test Case 3
        function testSnippet3() {
            const originalText = "Space exploration has reached new milestones with private companies joining government agencies in developing advanced spacecraft and planning missions to Mars.";
            const query = "space exploration news";
            
            const teaser = processSnippet(originalText);
            const linkedinUrl = generateLinkedInURL(query, originalText);
            
            document.getElementById('teaser-text3').textContent = teaser;
            document.getElementById('url3').textContent = linkedinUrl;
        }

        // OG Image preview functions
        function viewOGImage1() {
            const query = "artificial intelligence trends";
            const snippet = "Artificial intelligence is rapidly transforming industries across the globe. Machine learning algorithms are becoming increasingly sophisticated.";
            showOGImage(query, snippet);
        }

        function viewOGImage2() {
            const query = "climate change solutions";
            const snippet = "Climate change solutions are emerging through renewable energy innovations. Solar and wind technologies continue to improve efficiency.";
            showOGImage(query, snippet);
        }

        function viewOGImage3() {
            const query = "space exploration news";
            const snippet = "Space exploration has reached new milestones with private companies joining government agencies.";
            showOGImage(query, snippet);
        }

        function showOGImage(query, snippet) {
            const ogImageUrl = generateOGImageURL(query, snippet);
            const preview = document.getElementById('og-preview');
            preview.src = ogImageUrl;
            preview.style.display = 'block';
            
            console.log('OG Image URL:', ogImageUrl);
        }

        // Auto-run tests on page load
        window.addEventListener('load', () => {
            console.log('üîó LinkedIn Snippet Testing Page Loaded');
            
            // Auto-run first test
            testSnippet1();
            
            console.log('‚úÖ Enhanced snippet processing ready for testing');
        });
    </script>
</body>
</html>
